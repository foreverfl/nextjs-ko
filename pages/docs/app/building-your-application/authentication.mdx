---
title: ì¸ì¦
description: Next.js ì• í”Œë¦¬ì¼€ì´ì…˜ì—ì„œ ì¸ì¦ì„ êµ¬í˜„í•˜ëŠ” ë°©ë²•ì„ ì•Œì•„ë³´ì„¸ìš”.
---

import Image from "next/image";

# ì¸ì¦

ì• í”Œë¦¬ì¼€ì´ì…˜ì˜ ë°ì´í„°ë¥¼ ë³´í˜¸í•˜ê¸° ìœ„í•´ì„œëŠ” ì¸ì¦ì— ëŒ€í•œ ì´í•´ê°€ ì¤‘ìš”í•©ë‹ˆë‹¤. ì´ í˜ì´ì§€ì—ì„œëŠ” ì¸ì¦ì„ êµ¬í˜„í•˜ê¸° ìœ„í•´ ì–´ë–¤ Reactì™€ Next.js ê¸°ëŠ¥ì„ ì‚¬ìš©í•´ì•¼ í•˜ëŠ”ì§€ ì•ˆë‚´í•´ ë“œë¦¬ê² ìŠµë‹ˆë‹¤.

ì‹œì‘í•˜ê¸° ì „ì—, ì´ ê³¼ì •ì„ ì„¸ ê°€ì§€ ê°œë…ìœ¼ë¡œ ë‚˜ëˆ„ëŠ” ê²ƒì´ ë„ì›€ì´ ë©ë‹ˆë‹¤:

1. **[ì¸ì¦](#authentication)**: ì‚¬ìš©ìê°€ ìì‹ ì´ ì£¼ì¥í•˜ëŠ” ì‚¬ëŒì¸ì§€ í™•ì¸í•©ë‹ˆë‹¤. ì‚¬ìš©ìì—ê²Œ ì‚¬ìš©ì ì´ë¦„ê³¼ ë¹„ë°€ë²ˆí˜¸ì™€ ê°™ì´ ê°€ì§€ê³  ìˆëŠ” ê²ƒìœ¼ë¡œ ì‹ ì›ì„ ì¦ëª…í•˜ë„ë¡ ìš”êµ¬í•©ë‹ˆë‹¤.
2. **[ì„¸ì…˜ ê´€ë¦¬](#session-management)**: ìš”ì²­ ê°„ì— ì‚¬ìš©ìì˜ ì¸ì¦ ìƒíƒœë¥¼ ì¶”ì í•©ë‹ˆë‹¤.
3. **[ê¶Œí•œ ë¶€ì—¬](#authorization)**: ì‚¬ìš©ìê°€ ì ‘ê·¼í•  ìˆ˜ ìˆëŠ” ê²½ë¡œì™€ ë°ì´í„°ë¥¼ ê²°ì •í•©ë‹ˆë‹¤.

ì´ ë‹¤ì´ì–´ê·¸ë¨ì€ Reactì™€ Next.js ê¸°ëŠ¥ì„ ì‚¬ìš©í•œ ì¸ì¦ íë¦„ì„ ë³´ì—¬ì¤ë‹ˆë‹¤:

<Image
  alt="Reactì™€ Next.js ê¸°ëŠ¥ì„ ì‚¬ìš©í•œ ì¸ì¦ íë¦„ì„ ë³´ì—¬ì£¼ëŠ” ë‹¤ì´ì–´ê·¸ë¨"
  src="https://nextjs.org/_next/image?url=%2Fdocs%2Flight%2Fauthentication-overview.png&w=1920&q=75"
  width="1600"
  height="1383"
/>

ì´ í˜ì´ì§€ì˜ ì˜ˆì œë“¤ì€ êµìœ¡ ëª©ì ìœ¼ë¡œ ê¸°ë³¸ì ì¸ ì‚¬ìš©ì ì´ë¦„ê³¼ ë¹„ë°€ë²ˆí˜¸ ì¸ì¦ì„ ë‹¤ë£¹ë‹ˆë‹¤. ì§ì ‘ ì‚¬ìš©ì ì •ì˜ ì¸ì¦ ì†”ë£¨ì…˜ì„ êµ¬í˜„í•  ìˆ˜ ìˆì§€ë§Œ, ë³´ì•ˆ ê°•í™”ì™€ ë‹¨ìˆœí™”ë¥¼ ìœ„í•´ ì¸ì¦ ë¼ì´ë¸ŒëŸ¬ë¦¬ë¥¼ ì‚¬ìš©í•˜ëŠ” ê²ƒì„ ê¶Œì¥í•©ë‹ˆë‹¤. ì´ëŸ¬í•œ ë¼ì´ë¸ŒëŸ¬ë¦¬ë“¤ì€ ì¸ì¦, ì„¸ì…˜ ê´€ë¦¬, ê¶Œí•œ ë¶€ì—¬ì— ëŒ€í•œ ë‚´ì¥ ì†”ë£¨ì…˜ì„ ì œê³µí•˜ë©°, ì†Œì…œ ë¡œê·¸ì¸, ë‹¤ì¤‘ ìš”ì†Œ ì¸ì¦, ì—­í•  ê¸°ë°˜ ì ‘ê·¼ ì œì–´ì™€ ê°™ì€ ì¶”ê°€ ê¸°ëŠ¥ë„ ì œê³µí•©ë‹ˆë‹¤. [ì¸ì¦ ë¼ì´ë¸ŒëŸ¬ë¦¬](#auth-libraries) ì„¹ì…˜ì—ì„œ ëª©ë¡ì„ í™•ì¸í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

## ì¸ì¦

### íšŒì›ê°€ì… ë° ë¡œê·¸ì¸ ê¸°ëŠ¥

> **ì•Œì•„ë‘ë©´ ì¢‹ì€ ì **: ì´ ì˜ˆì œë“¤ì€ React 19 RCì—ì„œ ì‚¬ìš© ê°€ëŠ¥í•œ Reactì˜ `useActionState` í›…ì„ ì‚¬ìš©í•©ë‹ˆë‹¤. ì´ì „ ë²„ì „ì˜ Reactë¥¼ ì‚¬ìš©í•˜ê³  ìˆë‹¤ë©´ ëŒ€ì‹  `useFormState`ë¥¼ ì‚¬ìš©í•˜ì„¸ìš”. ìì„¸í•œ ì •ë³´ëŠ” [React ë¬¸ì„œ](https://react.dev/reference/react/useActionState)ë¥¼ ì°¸ì¡°í•˜ì„¸ìš”.

Reactì˜ [ì„œë²„ ì•¡ì…˜](/docs/app/building-your-application/data-fetching/server-actions-and-mutations)ì™€ [`useActionState`](https://react.dev/reference/react/useActionState)ì™€ í•¨ê»˜ [`<form>`](https://react.dev/reference/react-dom/components/form) ìš”ì†Œë¥¼ ì‚¬ìš©í•˜ì—¬ ì‚¬ìš©ì ìê²© ì¦ëª…ì„ ìº¡ì²˜í•˜ê³ , í¼ í•„ë“œë¥¼ ê²€ì¦í•˜ê³ , ì¸ì¦ ì œê³µìì˜ APIë‚˜ ë°ì´í„°ë² ì´ìŠ¤ë¥¼ í˜¸ì¶œí•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

ì„œë²„ ì•¡ì…˜ì€ í•­ìƒ ì„œë²„ì—ì„œ ì‹¤í–‰ë˜ë¯€ë¡œ ì¸ì¦ ë¡œì§ì„ ì²˜ë¦¬í•˜ê¸° ìœ„í•œ ì•ˆì „í•œ í™˜ê²½ì„ ì œê³µí•©ë‹ˆë‹¤.

íšŒì›ê°€ì…/ë¡œê·¸ì¸ ê¸°ëŠ¥ì„ êµ¬í˜„í•˜ëŠ” ë‹¨ê³„ëŠ” ë‹¤ìŒê³¼ ê°™ìŠµë‹ˆë‹¤:

#### 1. ì‚¬ìš©ì ìê²© ì¦ëª… ìˆ˜ì§‘í•˜ê¸°

ì‚¬ìš©ì ìê²© ì¦ëª…ì„ ìˆ˜ì§‘í•˜ê¸° ìœ„í•´, ì œì¶œ ì‹œ Server Actionì„ í˜¸ì¶œí•˜ëŠ” í¼ì„ ë§Œë“­ë‹ˆë‹¤. ì˜ˆë¥¼ ë“¤ì–´, ì‚¬ìš©ìì˜ ì´ë¦„, ì´ë©”ì¼, ë¹„ë°€ë²ˆí˜¸ë¥¼ ë°›ëŠ” íšŒì›ê°€ì… í¼ì…ë‹ˆë‹¤:

```tsx filename="app/ui/signup-form.tsx" switcher
import { signup } from "@/app/actions/auth";

export function SignupForm() {
  return (
    <form action={signup}>
      <div>
        <label htmlFor="name">Name</label>
        <input id="name" name="name" placeholder="Name" />
      </div>
      <div>
        <label htmlFor="email">Email</label>
        <input id="email" name="email" type="email" placeholder="Email" />
      </div>
      <div>
        <label htmlFor="password">Password</label>
        <input id="password" name="password" type="password" />
      </div>
      <button type="submit">Sign Up</button>
    </form>
  );
}
```

```jsx filename="app/ui/signup-form.js" switcher
import { signup } from "@/app/actions/auth";

export function SignupForm() {
  return (
    <form action={signup}>
      <div>
        <label htmlFor="name">Name</label>
        <input id="name" name="name" placeholder="Name" />
      </div>
      <div>
        <label htmlFor="email">Email</label>
        <input id="email" name="email" type="email" placeholder="Email" />
      </div>
      <div>
        <label htmlFor="password">Password</label>
        <input id="password" name="password" type="password" />
      </div>
      <button type="submit">Sign Up</button>
    </form>
  );
}
```

```tsx filename="app/actions/auth.tsx" switcher
export async function signup(formData: FormData) {}
```

```jsx filename="app/actions/auth.js" switcher
export async function signup(formData) {}
```

#### 2. ì„œë²„ì—ì„œ í¼ í•„ë“œ ê²€ì¦í•˜ê¸°

Server Actionì„ ì‚¬ìš©í•˜ì—¬ ì„œë²„ì—ì„œ í¼ í•„ë“œë¥¼ ê²€ì¦í•©ë‹ˆë‹¤. ì¸ì¦ ì œê³µìê°€ í¼ ê²€ì¦ì„ ì œê³µí•˜ì§€ ì•ŠëŠ” ê²½ìš°, [Zod](https://zod.dev/)ë‚˜ [Yup](https://github.com/jquense/yup)ê³¼ ê°™ì€ ìŠ¤í‚¤ë§ˆ(ë°ì´í„° í˜•ì‹) ê²€ì¦ ë¼ì´ë¸ŒëŸ¬ë¦¬ë¥¼ ì‚¬ìš©í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

Zodë¥¼ ì˜ˆë¡œ ë“¤ì–´, ì ì ˆí•œ ì˜¤ë¥˜ ë©”ì‹œì§€ì™€ í•¨ê»˜ í¼ ìŠ¤í‚¤ë§ˆë¥¼ ì •ì˜í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤:

```ts filename="app/lib/definitions.ts" switcher
import { z } from "zod";

export const SignupFormSchema = z.object({
  name: z
    .string()
    .min(2, { message: "Name must be at least 2 characters long." })
    .trim(),
  email: z.string().email({ message: "Please enter a valid email." }).trim(),
  password: z
    .string()
    .min(8, { message: "Be at least 8 characters long" })
    .regex(/[a-zA-Z]/, { message: "Contain at least one letter." })
    .regex(/[0-9]/, { message: "Contain at least one number." })
    .regex(/[^a-zA-Z0-9]/, {
      message: "Contain at least one special character.",
    })
    .trim(),
});

export type FormState =
  | {
      errors?: {
        name?: string[];
        email?: string[];
        password?: string[];
      };
      message?: string;
    }
  | undefined;
```

```js filename="app/lib/definitions.js" switcher
import { z } from "zod";

export const SignupFormSchema = z.object({
  name: z
    .string()
    .min(2, { message: "Name must be at least 2 characters long." })
    .trim(),
  email: z.string().email({ message: "Please enter a valid email." }).trim(),
  password: z
    .string()
    .min(8, { message: "Be at least 8 characters long" })
    .regex(/[a-zA-Z]/, { message: "Contain at least one letter." })
    .regex(/[0-9]/, { message: "Contain at least one number." })
    .regex(/[^a-zA-Z0-9]/, {
      message: "Contain at least one special character.",
    })
    .trim(),
});
```

ì¸ì¦ ì œê³µìì˜ APIë‚˜ ë°ì´í„°ë² ì´ìŠ¤ì— ë¶ˆí•„ìš”í•œ í˜¸ì¶œì„ ë°©ì§€í•˜ê¸° ìœ„í•´, í¼ í•„ë“œê°€ ì •ì˜ëœ ìŠ¤í‚¤ë§ˆì™€ ì¼ì¹˜í•˜ì§€ ì•Šì„ ê²½ìš° Server Actionì—ì„œ ì¼ì° `return`í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

```ts filename="app/actions/auth.ts" switcher
import { SignupFormSchema, FormState } from "@/app/lib/definitions";

export async function signup(state: FormState, formData: FormData) {
  // í¼ í•„ë“œ ê²€ì¦
  const validatedFields = SignupFormSchema.safeParse({
    name: formData.get("name"),
    email: formData.get("email"),
    password: formData.get("password"),
  });

  // í¼ í•„ë“œê°€ ìœ íš¨í•˜ì§€ ì•Šìœ¼ë©´ ì¼ì° ë¦¬í„´
  if (!validatedFields.success) {
    return {
      errors: validatedFields.error.flatten().fieldErrors,
    };
  }

  // ì‚¬ìš©ìë¥¼ ìƒì„±í•˜ê¸° ìœ„í•´ ì œê³µìë‚˜ ë°ì´í„°ë² ì´ìŠ¤ í˜¸ì¶œ...
}
```

```js filename="app/actions/auth.js" switcher
import { SignupFormSchema } from "@/app/lib/definitions";

export async function signup(state, formData) {
  // í¼ í•„ë“œ ê²€ì¦
  const validatedFields = SignupFormSchema.safeParse({
    name: formData.get("name"),
    email: formData.get("email"),
    password: formData.get("password"),
  });

  // í¼ í•„ë“œê°€ ìœ íš¨í•˜ì§€ ì•Šìœ¼ë©´ ì¼ì° ë¦¬í„´
  if (!validatedFields.success) {
    return {
      errors: validatedFields.error.flatten().fieldErrors,
    };
  }

  // ì‚¬ìš©ìë¥¼ ìƒì„±í•˜ê¸° ìœ„í•´ ì œê³µìë‚˜ ë°ì´í„°ë² ì´ìŠ¤ í˜¸ì¶œ...
}
```

`<SignupForm />`ìœ¼ë¡œ ëŒì•„ê°€ì„œ, Reactì˜ `useActionState()` í›…ì„ ì‚¬ìš©í•˜ì—¬ ê²€ì¦ ì˜¤ë¥˜ë¥¼ í‘œì‹œí•˜ê³  í¼ì´ ì œì¶œë˜ëŠ” ë™ì•ˆ ëŒ€ê¸° ìƒíƒœë¥¼ í‘œì‹œí•  ìˆ˜ ìˆìŠµë‹ˆë‹¤:

```tsx filename="app/ui/signup-form.tsx" switcher highlight={7,15,21,27-39}
"use client";

import { useActionState } from "react";
import { signup } from "@/app/actions/auth";

export function SignupForm() {
  const [state, action, pending] = useActionState(signup, undefined);

  return (
    <form action={action}>
      <div>
        <label htmlFor="name">Name</label>
        <input id="name" name="name" placeholder="Name" />
      </div>
      {state?.errors?.name && <p>{state.errors.name}</p>}

      <div>
        <label htmlFor="email">Email</label>
        <input id="email" name="email" placeholder="Email" />
      </div>
      {state?.errors?.email && <p>{state.errors.email}</p>}

      <div>
        <label htmlFor="password">Password</label>
        <input id="password" name="password" type="password" />
      </div>
      {state?.errors?.password && (
        <div>
          <p>Password must:</p>
          <ul>
            {state.errors.password.map((error) => (
              <li key={error}>- {error}</li>
            ))}
          </ul>
        </div>
      )}
      <button aria-disabled={pending} type="submit">
        {pending ? "Submitting..." : "Sign up"}
      </button>
    </form>
  );
}
```

```jsx filename="app/ui/signup-form.js" switcher highlight={7,15,21,27-39}
"use client";

import { useActionState } from "react";
import { signup } from "@/app/actions/auth";

export function SignupForm() {
  const [state, action, pending] = useActionState(signup, undefined);

  return (
    <form action={action}>
      <div>
        <label htmlFor="name">Name</label>
        <input id="name" name="name" placeholder="John Doe" />
      </div>
      {state.errors.name && <p>{state.errors.name}</p>}

      <div>
        <label htmlFor="email">Email</label>
        <input id="email" name="email" placeholder="john@example.com" />
      </div>
      {state.errors.email && <p>{state.errors.email}</p>}

      <div>
        <label htmlFor="password">Password</label>
        <input id="password" name="password" type="password" />
      </div>
      {state.errors.password && (
        <div>
          <p>Password must:</p>
          <ul>
            {state.errors.password.map((error) => (
              <li key={error}>- {error}</li>
            ))}
          </ul>
        </div>
      )}
      <button aria-disabled={pending} type="submit">
        {pending ? "Submitting..." : "Sign up"}
      </button>
    </form>
  );
}
```

> **ì•Œì•„ë‘ë©´ ì¢‹ì€ ì :** ëŒ€ì•ˆìœ¼ë¡œ, [`useFormStatus`](https://ko.react.dev/reference/react-dom/hooks/useFormStatus) í›…ì„ ì‚¬ìš©í•˜ì—¬ ëŒ€ê¸° ìƒíƒœë¥¼ í‘œì‹œí•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

#### 3. ì‚¬ìš©ì ìƒì„± ë˜ëŠ” ì‚¬ìš©ì ìê²© ì¦ëª… í™•ì¸í•˜ê¸°

í¼ í•„ë“œë¥¼ ê²€ì¦í•œ í›„, ì¸ì¦ ì œê³µìì˜ APIë‚˜ ë°ì´í„°ë² ì´ìŠ¤ë¥¼ í˜¸ì¶œí•˜ì—¬ ìƒˆ ì‚¬ìš©ì ê³„ì •ì„ ìƒì„±í•˜ê±°ë‚˜ ì‚¬ìš©ìê°€ ì¡´ì¬í•˜ëŠ”ì§€ í™•ì¸í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

ì´ì „ ì˜ˆì œì— ì´ì–´ì„œ:

```tsx filename="app/actions/auth.tsx" switcher
export async function signup(state: FormState, formData: FormData) {
  // 1. í¼ í•„ë“œ ê²€ì¦
  // ...

  // 2. ë°ì´í„°ë² ì´ìŠ¤ì— ì‚½ì…í•  ë°ì´í„° ì¤€ë¹„
  const { name, email, password } = validatedFields.data;
  // ì˜ˆ: ì €ì¥í•˜ê¸° ì „ì— ì‚¬ìš©ìì˜ ë¹„ë°€ë²ˆí˜¸ë¥¼ í•´ì‹œí™”
  const hashedPassword = await bcrypt.hash(password, 10);

  // 3. ì‚¬ìš©ìë¥¼ ë°ì´í„°ë² ì´ìŠ¤ì— ì‚½ì…í•˜ê±°ë‚˜ ì¸ì¦ ë¼ì´ë¸ŒëŸ¬ë¦¬ì˜ API í˜¸ì¶œ
  const data = await db
    .insert(users)
    .values({
      name,
      email,
      password: hashedPassword,
    })
    .returning({ id: users.id });

  const user = data[0];

  if (!user) {
    return {
      message: "An error occurred while creating your account.",
    };
  }

  // TODO:
  // 4. ì‚¬ìš©ì ì„¸ì…˜ ìƒì„±
  // 5. ì‚¬ìš©ì ë¦¬ë””ë ‰ì…˜
}
```

```jsx filename="app/actions/auth.js" switcher
export async function signup(state, formData) {
  // 1. í¼ í•„ë“œ ê²€ì¦
  // ...

  // 2. ë°ì´í„°ë² ì´ìŠ¤ì— ì‚½ì…í•  ë°ì´í„° ì¤€ë¹„
  const { name, email, password } = validatedFields.data;
  // ì˜ˆ: ì €ì¥í•˜ê¸° ì „ì— ì‚¬ìš©ìì˜ ë¹„ë°€ë²ˆí˜¸ë¥¼ í•´ì‹œí™”
  const hashedPassword = await bcrypt.hash(password, 10);

  // 3. ì‚¬ìš©ìë¥¼ ë°ì´í„°ë² ì´ìŠ¤ì— ì‚½ì…í•˜ê±°ë‚˜ ë¼ì´ë¸ŒëŸ¬ë¦¬ API í˜¸ì¶œ
  const data = await db
    .insert(users)
    .values({
      name,
      email,
      password: hashedPassword,
    })
    .returning({ id: users.id });

  const user = data[0];

  if (!user) {
    return {
      message: "An error occurred while creating your account.",
    };
  }

  // TODO:
  // 4. ì‚¬ìš©ì ì„¸ì…˜ ìƒì„±
  // 5. ì‚¬ìš©ì ë¦¬ë””ë ‰ì…˜
}
```

ì‚¬ìš©ì ê³„ì •ì„ ì„±ê³µì ìœ¼ë¡œ ìƒì„±í•˜ê±°ë‚˜ ì‚¬ìš©ì ìê²© ì¦ëª…ì„ í™•ì¸í•œ í›„, ì‚¬ìš©ìì˜ ì¸ì¦ ìƒíƒœë¥¼ ê´€ë¦¬í•˜ê¸° ìœ„í•œ ì„¸ì…˜ì„ ìƒì„±í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ì„¸ì…˜ ê´€ë¦¬ ì „ëµì— ë”°ë¼ ì„¸ì…˜ì„ ì¿ í‚¤ë‚˜ ë°ì´í„°ë² ì´ìŠ¤, ë˜ëŠ” ë‘˜ ë‹¤ì— ì €ì¥í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ìì„¸í•œ ë‚´ìš©ì€ [ì„¸ì…˜ ê´€ë¦¬](#session-management) ì„¹ì…˜ì„ ê³„ì† ì½ì–´ë³´ì„¸ìš”.

> **íŒ:**
>
> - ìœ„ì˜ ì˜ˆì œëŠ” êµìœ¡ ëª©ì ìœ¼ë¡œ ì¸ì¦ ë‹¨ê³„ë¥¼ ìƒì„¸íˆ ì„¤ëª…í•˜ê¸° ìœ„í•´ ìƒë‹¹íˆ ì¥í™©í•©ë‹ˆë‹¤. ì´ëŠ” ìì²´ì ìœ¼ë¡œ ì•ˆì „í•œ ì†”ë£¨ì…˜ì„ êµ¬í˜„í•˜ëŠ” ê²ƒì´ ì–¼ë§ˆë‚˜ ë¹ ë¥´ê²Œ ë³µì¡í•´ì§ˆ ìˆ˜ ìˆëŠ”ì§€ë¥¼ ê°•ì¡°í•©ë‹ˆë‹¤. ì´ ê³¼ì •ì„ ë‹¨ìˆœí™”í•˜ê¸° ìœ„í•´ [ì¸ì¦ ë¼ì´ë¸ŒëŸ¬ë¦¬](#auth-libraries)ë¥¼ ì‚¬ìš©í•˜ëŠ” ê²ƒì„ ê³ ë ¤í•´ë³´ì„¸ìš”.
> - ì‚¬ìš©ì ê²½í—˜ì„ ê°œì„ í•˜ê¸° ìœ„í•´, ë“±ë¡ ê³¼ì • ì´ˆê¸°ì— ì¤‘ë³µëœ ì´ë©”ì¼ì´ë‚˜ ì‚¬ìš©ì ì´ë¦„ì„ í™•ì¸í•˜ê³  ì‹¶ì„ ìˆ˜ ìˆìŠµë‹ˆë‹¤. ì˜ˆë¥¼ ë“¤ì–´, ì‚¬ìš©ìê°€ ì‚¬ìš©ì ì´ë¦„ì„ ì…ë ¥í•˜ê±°ë‚˜ ì…ë ¥ í•„ë“œì—ì„œ í¬ì»¤ìŠ¤ë¥¼ ìƒì„ ë•Œ í™•ì¸í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ì´ëŠ” ë¶ˆí•„ìš”í•œ í¼ ì œì¶œì„ ë°©ì§€í•˜ê³  ì‚¬ìš©ìì—ê²Œ ì¦‰ê°ì ì¸ í”¼ë“œë°±ì„ ì œê³µí•˜ëŠ” ë° ë„ì›€ì´ ë©ë‹ˆë‹¤. [use-debounce](https://www.npmjs.com/package/use-debounce)ì™€ ê°™ì€ ë¼ì´ë¸ŒëŸ¬ë¦¬ë¥¼ ì‚¬ìš©í•˜ì—¬ ì´ëŸ¬í•œ í™•ì¸ì˜ ë¹ˆë„ë¥¼ ê´€ë¦¬í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

## ì„¸ì…˜ ê´€ë¦¬

ì„¸ì…˜ ê´€ë¦¬ëŠ” ìš”ì²­ ê°„ì— ì‚¬ìš©ìì˜ ì¸ì¦ ìƒíƒœê°€ ìœ ì§€ë˜ë„ë¡ ë³´ì¥í•©ë‹ˆë‹¤. ì—¬ê¸°ì—ëŠ” ì„¸ì…˜ì´ë‚˜ í† í°ì˜ ìƒì„±, ì €ì¥, ìƒˆë¡œ ê³ ì¹¨, ì‚­ì œê°€ í¬í•¨ë©ë‹ˆë‹¤.

ë‘ ê°€ì§€ ìœ í˜•ì˜ ì„¸ì…˜ì´ ìˆìŠµë‹ˆë‹¤:

1. [**ë¬´ìƒíƒœ**](#stateless-sessions): ì„¸ì…˜ ë°ì´í„°(ë˜ëŠ” í† í°)ê°€ ë¸Œë¼ìš°ì €ì˜ ì¿ í‚¤ì— ì €ì¥ë©ë‹ˆë‹¤. ì¿ í‚¤ëŠ” ê° ìš”ì²­ê³¼ í•¨ê»˜ ì „ì†¡ë˜ì–´ ì„œë²„ì—ì„œ ì„¸ì…˜ì„ í™•ì¸í•  ìˆ˜ ìˆê²Œ í•©ë‹ˆë‹¤. ì´ ë°©ë²•ì€ ë” ë‹¨ìˆœí•˜ì§€ë§Œ, ì˜¬ë°”ë¥´ê²Œ êµ¬í˜„ë˜ì§€ ì•Šìœ¼ë©´ ëœ ì•ˆì „í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.
2. [**ë°ì´í„°ë² ì´ìŠ¤**](#database-sessions): ì„¸ì…˜ ë°ì´í„°ê°€ ë°ì´í„°ë² ì´ìŠ¤ì— ì €ì¥ë˜ê³ , ì‚¬ìš©ìì˜ ë¸Œë¼ìš°ì €ëŠ” ì•”í˜¸í™”ëœ ì„¸ì…˜ IDë§Œ ë°›ìŠµë‹ˆë‹¤. ì´ ë°©ë²•ì€ ë” ì•ˆì „í•˜ì§€ë§Œ, ë³µì¡í•˜ê³  ë” ë§ì€ ì„œë²„ ë¦¬ì†ŒìŠ¤ë¥¼ ì‚¬ìš©í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

> **ì•Œì•„ë‘ë©´ ì¢‹ì€ ì :** ë‘ ë°©ë²• ì¤‘ í•˜ë‚˜ë¥¼ ì‚¬ìš©í•˜ê±°ë‚˜ ë‘˜ ë‹¤ ì‚¬ìš©í•  ìˆ˜ ìˆì§€ë§Œ, [iron-session](https://github.com/vvo/iron-session)ì´ë‚˜ [Jose](https://github.com/panva/jose)ì™€ ê°™ì€ ì„¸ì…˜ ê´€ë¦¬ ë¼ì´ë¸ŒëŸ¬ë¦¬ë¥¼ ì‚¬ìš©í•˜ëŠ” ê²ƒì„ ê¶Œì¥í•©ë‹ˆë‹¤.

### ë¬´ìƒíƒœ ì„¸ì…˜

ë¬´ìƒíƒœ ì„¸ì…˜ì„ ìƒì„±í•˜ê³  ê´€ë¦¬í•˜ë ¤ë©´ ë‹¤ìŒ ë‹¨ê³„ë¥¼ ë”°ë¼ì•¼ í•©ë‹ˆë‹¤:

1. ì„¸ì…˜ì— ì„œëª…í•˜ëŠ” ë° ì‚¬ìš©ë  ë¹„ë°€ í‚¤ë¥¼ ìƒì„±í•˜ê³  [í™˜ê²½ ë³€ìˆ˜](/docs/app/building-your-application/configuring/environment-variables)ë¡œ ì €ì¥í•©ë‹ˆë‹¤.
2. ì„¸ì…˜ ê´€ë¦¬ ë¼ì´ë¸ŒëŸ¬ë¦¬ë¥¼ ì‚¬ìš©í•˜ì—¬ ì„¸ì…˜ ë°ì´í„°ë¥¼ ì•”í˜¸í™”/ë³µí˜¸í™”í•˜ëŠ” ë¡œì§ì„ ì‘ì„±í•©ë‹ˆë‹¤.
3. Next.js [`cookies()`](/docs/app/api-reference/functions/cookies) APIë¥¼ ì‚¬ìš©í•˜ì—¬ ì¿ í‚¤ë¥¼ ê´€ë¦¬í•©ë‹ˆë‹¤.

ìœ„ì˜ ë‚´ìš© ì™¸ì—ë„, ì‚¬ìš©ìê°€ ì• í”Œë¦¬ì¼€ì´ì…˜ìœ¼ë¡œ ëŒì•„ì˜¬ ë•Œ ì„¸ì…˜ì„ [ì—…ë°ì´íŠ¸(ë˜ëŠ” ìƒˆë¡œ ê³ ì¹¨)](#updating-or-refreshing-sessions)í•˜ê³ , ì‚¬ìš©ìê°€ ë¡œê·¸ì•„ì›ƒí•  ë•Œ ì„¸ì…˜ì„ [ì‚­ì œ](#deleting-the-session)í•˜ëŠ” ê¸°ëŠ¥ì„ ì¶”ê°€í•˜ëŠ” ê²ƒì„ ê³ ë ¤í•´ë³´ì„¸ìš”.

> **ì•Œì•„ë‘ë©´ ì¢‹ì€ ì :** [ì¸ì¦ ë¼ì´ë¸ŒëŸ¬ë¦¬](#auth-libraries)ì— ì„¸ì…˜ ê´€ë¦¬ê°€ í¬í•¨ë˜ì–´ ìˆëŠ”ì§€ í™•ì¸í•˜ì„¸ìš”.

#### 1. ë¹„ë°€ í‚¤ ìƒì„±í•˜ê¸°

ì„¸ì…˜ì— ì„œëª…í•  ë¹„ë°€ í‚¤ë¥¼ ìƒì„±í•˜ëŠ” ë°©ë²•ì€ ì—¬ëŸ¬ ê°€ì§€ê°€ ìˆìŠµë‹ˆë‹¤. ì˜ˆë¥¼ ë“¤ì–´, í„°ë¯¸ë„ì—ì„œ `openssl` ëª…ë ¹ì„ ì‚¬ìš©í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤:

```bash filename="terminal"
openssl rand -base64 32
```

ì´ ëª…ë ¹ì€ ë¹„ë°€ í‚¤ë¡œ ì‚¬ìš©í•  ìˆ˜ ìˆëŠ” 32ìì˜ ë¬´ì‘ìœ„ ë¬¸ìì—´ì„ ìƒì„±í•˜ë©°, ì´ë¥¼ [í™˜ê²½ ë³€ìˆ˜ íŒŒì¼](/docs/app/building-your-application/configuring/environment-variables)ì— ì €ì¥í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤:

```bash filename=".env"
SESSION_SECRET=your_secret_key
```

ê·¸ëŸ° ë‹¤ìŒ ì„¸ì…˜ ê´€ë¦¬ ë¡œì§ì—ì„œ ì´ í‚¤ë¥¼ ì°¸ì¡°í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤:

```js filename="app/lib/session.js"
const secretKey = process.env.SESSION_SECRET;
```

#### 2. ì„¸ì…˜ ì•”í˜¸í™” ë° ë³µí˜¸í™”í•˜ê¸°

ë‹¤ìŒìœ¼ë¡œ, ì„ í˜¸í•˜ëŠ” [ì„¸ì…˜ ê´€ë¦¬ ë¼ì´ë¸ŒëŸ¬ë¦¬](#session-management-libraries)ë¥¼ ì‚¬ìš©í•˜ì—¬ ì„¸ì…˜ì„ ì•”í˜¸í™”í•˜ê³  ë³µí˜¸í™”í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ì´ì „ ì˜ˆì œì— ì´ì–´ì„œ, [Jose](https://www.npmjs.com/package/jose)([Edge Runtime](/docs/app/building-your-application/rendering/edge-and-nodejs-runtimes)ê³¼ í˜¸í™˜ë¨)ì™€ Reactì˜ [`server-only`](https://www.npmjs.com/package/server-only) íŒ¨í‚¤ì§€ë¥¼ ì‚¬ìš©í•˜ì—¬ ì„¸ì…˜ ê´€ë¦¬ ë¡œì§ì´ ì„œë²„ì—ì„œë§Œ ì‹¤í–‰ë˜ë„ë¡ ë³´ì¥í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

```tsx filename="app/lib/session.ts" switcher
import "server-only";
import { SignJWT, jwtVerify } from "jose";
import { SessionPayload } from "@/app/lib/definitions";

const secretKey = process.env.SESSION_SECRET;
const encodedKey = new TextEncoder().encode(secretKey);

export async function encrypt(payload: SessionPayload) {
  return new SignJWT(payload)
    .setProtectedHeader({ alg: "HS256" })
    .setIssuedAt()
    .setExpirationTime("7d")
    .sign(encodedKey);
}

export async function decrypt(session: string | undefined = "") {
  try {
    const { payload } = await jwtVerify(session, encodedKey, {
      algorithms: ["HS256"],
    });
    return payload;
  } catch (error) {
    console.log("Failed to verify session");
  }
}
```

```jsx filename="app/lib/session.js" switcher
import "server-only";
import { SignJWT, jwtVerify } from "jose";

const secretKey = process.env.SESSION_SECRET;
const encodedKey = new TextEncoder().encode(secretKey);

export async function encrypt(payload) {
  return new SignJWT(payload)
    .setProtectedHeader({ alg: "HS256" })
    .setIssuedAt()
    .setExpirationTime("7d")
    .sign(encodedKey);
}

export async function decrypt(session) {
  try {
    const { payload } = await jwtVerify(session, encodedKey, {
      algorithms: ["HS256"],
    });
    return payload;
  } catch (error) {
    console.log("Failed to verify session");
  }
}
```

> **íŒ**:
>
> - í˜ì´ë¡œë“œëŠ” í›„ì† ìš”ì²­ì—ì„œ ì‚¬ìš©ë  **ìµœì†Œí•œì˜**, ê³ ìœ í•œ ì‚¬ìš©ì ë°ì´í„°(ì˜ˆ: ì‚¬ìš©ì ID, ì—­í•  ë“±)ë§Œ í¬í•¨í•´ì•¼ í•©ë‹ˆë‹¤. ì „í™”ë²ˆí˜¸, ì´ë©”ì¼ ì£¼ì†Œ, ì‹ ìš©ì¹´ë“œ ì •ë³´ ë“± ê°œì¸ ì‹ë³„ ì •ë³´ë‚˜ ë¹„ë°€ë²ˆí˜¸ì™€ ê°™ì€ ë¯¼ê°í•œ ë°ì´í„°ë¥¼ í¬í•¨í•´ì„œëŠ” ì•ˆ ë©ë‹ˆë‹¤.

#### 3. ì¿ í‚¤ ì„¤ì •í•˜ê¸° (ê¶Œì¥ ì˜µì…˜)

ì„¸ì…˜ì„ ì¿ í‚¤ì— ì €ì¥í•˜ë ¤ë©´ Next.js [`cookies()`](/docs/app/api-reference/functions/cookies) APIë¥¼ ì‚¬ìš©í•˜ì„¸ìš”. ì¿ í‚¤ëŠ” ì„œë²„ì—ì„œ ì„¤ì •ë˜ì–´ì•¼ í•˜ë©°, ë‹¤ìŒê³¼ ê°™ì€ ê¶Œì¥ ì˜µì…˜ì„ í¬í•¨í•´ì•¼ í•©ë‹ˆë‹¤:

- **HttpOnly**: í´ë¼ì´ì–¸íŠ¸ ì¸¡ JavaScriptê°€ ì¿ í‚¤ì— ì ‘ê·¼í•˜ëŠ” ê²ƒì„ ë°©ì§€í•©ë‹ˆë‹¤.
- **Secure**: httpsë¥¼ ì‚¬ìš©í•˜ì—¬ ì¿ í‚¤ë¥¼ ì „ì†¡í•©ë‹ˆë‹¤.
- **SameSite**: ì¿ í‚¤ê°€ í¬ë¡œìŠ¤ ì‚¬ì´íŠ¸ ìš”ì²­ê³¼ í•¨ê»˜ ì „ì†¡ë  ìˆ˜ ìˆëŠ”ì§€ ì§€ì •í•©ë‹ˆë‹¤.
- **Max-Age ë˜ëŠ” Expires**: ì¼ì • ê¸°ê°„ í›„ ì¿ í‚¤ë¥¼ ì‚­ì œí•©ë‹ˆë‹¤.
- **Path**: ì¿ í‚¤ì˜ URL ê²½ë¡œë¥¼ ì •ì˜í•©ë‹ˆë‹¤.

ì´ëŸ¬í•œ ê° ì˜µì…˜ì— ëŒ€í•œ ìì„¸í•œ ì •ë³´ëŠ” [MDN](https://developer.mozilla.org/ko/docs/Web/HTTP/Cookies)ì„ ì°¸ì¡°í•˜ì„¸ìš”.

```ts filename="app/lib/session.ts" switcher
import "server-only";
import { cookies } from "next/headers";

export async function createSession(userId: string) {
  const expiresAt = new Date(Date.now() + 7 * 24 * 60 * 60 * 1000);
  const session = await encrypt({ userId, expiresAt });

  cookies().set("session", session, {
    httpOnly: true,
    secure: true,
    expires: expiresAt,
    sameSite: "lax",
    path: "/",
  });
}
```

```js filename="app/lib/session.js" switcher
import "server-only";
import { cookies } from "next/headers";

export async function createSession(userId) {
  const expiresAt = new Date(Date.now() + 7 * 24 * 60 * 60 * 1000);
  const session = await encrypt({ userId, expiresAt });

  cookies().set("session", session, {
    httpOnly: true,
    secure: true,
    expires: expiresAt,
    sameSite: "lax",
    path: "/",
  });
}
```

Server Actionìœ¼ë¡œ ëŒì•„ê°€ì„œ, `createSession()` í•¨ìˆ˜ë¥¼ í˜¸ì¶œí•˜ê³  [`redirect()`](/docs/app/building-your-application/routing/redirecting) APIë¥¼ ì‚¬ìš©í•˜ì—¬ ì‚¬ìš©ìë¥¼ ì ì ˆí•œ í˜ì´ì§€ë¡œ ë¦¬ë””ë ‰ì…˜í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤:

```ts filename="app/actions/auth.ts" switcher
import { createSession } from "@/app/lib/session";

export async function signup(state: FormState, formData: FormData) {
  // ì´ì „ ë‹¨ê³„:
  // 1. í¼ í•„ë“œ ê²€ì¦
  // 2. ë°ì´í„°ë² ì´ìŠ¤ì— ì‚½ì…í•  ë°ì´í„° ì¤€ë¹„
  // 3. ì‚¬ìš©ìë¥¼ ë°ì´í„°ë² ì´ìŠ¤ì— ì‚½ì…í•˜ê±°ë‚˜ ë¼ì´ë¸ŒëŸ¬ë¦¬ API í˜¸ì¶œ

  // í˜„ì¬ ë‹¨ê³„:
  // 4. ì‚¬ìš©ì ì„¸ì…˜ ìƒì„±
  await createSession(user.id);
  // 5. ì‚¬ìš©ì ë¦¬ë””ë ‰ì…˜
  redirect("/profile");
}
```

```js filename="app/actions/auth.js" switcher
import { createSession } from "@/app/lib/session";

export async function signup(state, formData) {
  // ì´ì „ ë‹¨ê³„:
  // 1. í¼ í•„ë“œ ê²€ì¦
  // 2. ë°ì´í„°ë² ì´ìŠ¤ì— ì‚½ì…í•  ë°ì´í„° ì¤€ë¹„
  // 3. ì‚¬ìš©ìë¥¼ ë°ì´í„°ë² ì´ìŠ¤ì— ì‚½ì…í•˜ê±°ë‚˜ ë¼ì´ë¸ŒëŸ¬ë¦¬ API í˜¸ì¶œ

  // í˜„ì¬ ë‹¨ê³„:
  // 4. ì‚¬ìš©ì ì„¸ì…˜ ìƒì„±
  await createSession(user.id);
  // 5. ì‚¬ìš©ì ë¦¬ë””ë ‰ì…˜
  redirect("/profile");
}
```

> **íŒ**:
>
> - **ì¿ í‚¤ëŠ” ì„œë²„ì—ì„œ ì„¤ì •ë˜ì–´ì•¼ í•©ë‹ˆë‹¤** í´ë¼ì´ì–¸íŠ¸ ì¸¡ ë³€ì¡°ë¥¼ ë°©ì§€í•˜ê¸° ìœ„í•´ì„œì…ë‹ˆë‹¤.
> - ğŸ¥ ì‹œì²­í•˜ê¸°: Next.jsë¥¼ ì‚¬ìš©í•œ ë¬´ìƒíƒœ ì„¸ì…˜ê³¼ ì¸ì¦ì— ëŒ€í•´ ë” ìì„¸íˆ ì•Œì•„ë³´ê¸° â†’ [YouTube (11ë¶„)](https://www.youtube.com/watch?v=DJvM2lSPn6w).

#### ì„¸ì…˜ ì—…ë°ì´íŠ¸ (ë˜ëŠ” ìƒˆë¡œ ê³ ì¹¨)

ì„¸ì…˜ì˜ ë§Œë£Œ ì‹œê°„ì„ ì—°ì¥í•  ìˆ˜ë„ ìˆìŠµë‹ˆë‹¤. ì´ëŠ” ì‚¬ìš©ìê°€ ì• í”Œë¦¬ì¼€ì´ì…˜ì— ë‹¤ì‹œ ì ‘ê·¼í•œ í›„ì—ë„ ë¡œê·¸ì¸ ìƒíƒœë¥¼ ìœ ì§€í•˜ëŠ” ë° ìœ ìš©í•©ë‹ˆë‹¤. ì˜ˆë¥¼ ë“¤ì–´:

```ts filename="app/lib/session.ts" switcher
import "server-only";
import { cookies } from "next/headers";
import { decrypt } from "@/app/lib/session";

export async function updateSession() {
  const session = cookies().get("session")?.value;
  const payload = await decrypt(session);

  if (!session || !payload) {
    return null;
  }

  const expires = new Date(Date.now() + 7 * 24 * 60 * 60 * 1000);
  cookies().set("session", session, {
    httpOnly: true,
    secure: true,
    expires: expires,
    sameSite: "lax",
    path: "/",
  });
}
```

```js filename="app/lib/session.js" switcher
import "server-only";
import { cookies } from "next/headers";
import { decrypt } from "@/app/lib/session";

export async function updateSession() {
  const session = cookies().get("session").value;
  const payload = await decrypt(session);

  if (!session || !payload) {
    return null;
  }

  const expires = new Date(Date.now() + 7 * 24 * 60 * 60 * 1000);
  cookies().set("session", session, {
    httpOnly: true,
    secure: true,
    expires: expires,
    sameSite: "lax",
    path: "/",
  });
}
```

> **íŒ:** ì¸ì¦ ë¼ì´ë¸ŒëŸ¬ë¦¬ê°€ ìƒˆë¡œ ê³ ì¹¨ í† í°ì„ ì§€ì›í•˜ëŠ”ì§€ í™•ì¸í•˜ì„¸ìš”. ìƒˆë¡œ ê³ ì¹¨ í† í°ì€ ì‚¬ìš©ìì˜ ì„¸ì…˜ì„ ì—°ì¥í•˜ëŠ” ë° ì‚¬ìš©ë  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

#### ì„¸ì…˜ ì‚­ì œí•˜ê¸°

ì„¸ì…˜ì„ ì‚­ì œí•˜ë ¤ë©´ ì¿ í‚¤ë¥¼ ì‚­ì œí•˜ë©´ ë©ë‹ˆë‹¤:

```ts filename="app/lib/session.ts" switcher
import "server-only";
import { cookies } from "next/headers";

export function deleteSession() {
  cookies().delete("session");
}
```

```js filename="app/lib/session.js" switcher
import "server-only";
import { cookies } from "next/headers";

export function deleteSession() {
  cookies().delete("session");
}
```

ê·¸ëŸ° ë‹¤ìŒ ì• í”Œë¦¬ì¼€ì´ì…˜ì—ì„œ `deleteSession()` í•¨ìˆ˜ë¥¼ ì¬ì‚¬ìš©í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ì˜ˆë¥¼ ë“¤ì–´, ë¡œê·¸ì•„ì›ƒ ì‹œ:

```ts filename="app/actions/auth.ts" switcher
import { cookies } from "next/headers";
import { deleteSession } from "@/app/lib/session";

export async function logout() {
  deleteSession();
  redirect("/login");
}
```

```js filename="app/actions/auth.js" switcher
import { cookies } from "next/headers";
import { deleteSession } from "@/app/lib/session";

export async function logout() {
  deleteSession();
  redirect("/login");
}
```

### ë°ì´í„°ë² ì´ìŠ¤ ì„¸ì…˜

ë°ì´í„°ë² ì´ìŠ¤ ì„¸ì…˜ì„ ìƒì„±í•˜ê³  ê´€ë¦¬í•˜ë ¤ë©´ ë‹¤ìŒ ë‹¨ê³„ë¥¼ ë”°ë¼ì•¼ í•©ë‹ˆë‹¤:

1. ë°ì´í„°ë² ì´ìŠ¤ì— ì„¸ì…˜ê³¼ ë°ì´í„°ë¥¼ ì €ì¥í•  í…Œì´ë¸”ì„ ìƒì„±í•©ë‹ˆë‹¤ (ë˜ëŠ” ì¸ì¦ ë¼ì´ë¸ŒëŸ¬ë¦¬ê°€ ì´ë¥¼ ì²˜ë¦¬í•˜ëŠ”ì§€ í™•ì¸í•©ë‹ˆë‹¤).
2. ì„¸ì…˜ì„ ì‚½ì…, ì—…ë°ì´íŠ¸, ì‚­ì œí•˜ëŠ” ê¸°ëŠ¥ì„ êµ¬í˜„í•©ë‹ˆë‹¤.
3. ì‚¬ìš©ìì˜ ë¸Œë¼ìš°ì €ì— ì €ì¥í•˜ê¸° ì „ì— ì„¸ì…˜ IDë¥¼ ì•”í˜¸í™”í•˜ê³ , ë°ì´í„°ë² ì´ìŠ¤ì™€ ì¿ í‚¤ê°€ ë™ê¸°í™” ìƒíƒœë¥¼ ìœ ì§€í•˜ë„ë¡ í•©ë‹ˆë‹¤ (ì´ëŠ” ì„ íƒ ì‚¬í•­ì´ì§€ë§Œ, [ë¯¸ë“¤ì›¨ì–´ì—ì„œ ë‚™ê´€ì  ì¸ì¦ í™•ì¸](#optimistic-checks-with-middleware-optional)ì„ ìœ„í•´ ê¶Œì¥ë©ë‹ˆë‹¤).

ì˜ˆë¥¼ ë“¤ì–´:

```ts filename="app/lib/session.ts" switcher
import cookies from "next/headers";
import { db } from "@/app/lib/db";
import { encrypt } from "@/app/lib/session";

export async function createSession(id: number) {
  const expiresAt = new Date(Date.now() + 7 * 24 * 60 * 60 * 1000);

  // 1. ë°ì´í„°ë² ì´ìŠ¤ì— ì„¸ì…˜ ìƒì„±
  const data = await db
    .insert(sessions)
    .values({
      userId: id,
      expiresAt,
    })
    // ì„¸ì…˜ ID ë°˜í™˜
    .returning({ id: sessions.id });

  const sessionId = data[0].id;

  // 2. ì„¸ì…˜ ID ì•”í˜¸í™”
  const session = await encrypt({ sessionId, expiresAt });

  // 3. ë‚™ê´€ì  ì¸ì¦ í™•ì¸ì„ ìœ„í•´ ì„¸ì…˜ì„ ì¿ í‚¤ì— ì €ì¥
  cookies().set("session", session, {
    httpOnly: true,
    secure: true,
    expires: expiresAt,
    sameSite: "lax",
    path: "/",
  });
}
```

```js filename="app/lib/session.js" switcher
import cookies from "next/headers";
import { db } from "@/app/lib/db";
import { encrypt } from "@/app/lib/session";

export async function createSession(id) {
  const expiresAt = new Date(Date.now() + 7 * 24 * 60 * 60 * 1000);

  // 1. ë°ì´í„°ë² ì´ìŠ¤ì— ì„¸ì…˜ ìƒì„±
  const data = await db
    .insert(sessions)
    .values({
      userId: id,
      expiresAt,
    })
    // ì„¸ì…˜ ID ë°˜í™˜
    .returning({ id: sessions.id });

  const sessionId = data[0].id;

  // 2. ì„¸ì…˜ ID ì•”í˜¸í™”
  const session = await encrypt({ sessionId, expiresAt });

  // 3. ë‚™ê´€ì  ì¸ì¦ í™•ì¸ì„ ìœ„í•´ ì„¸ì…˜ì„ ì¿ í‚¤ì— ì €ì¥
  cookies().set("session", session, {
    httpOnly: true,
    secure: true,
    expires: expiresAt,
    sameSite: "lax",
    path: "/",
  });
}
```

> **íŒ**:
>
> - ë” ë¹ ë¥¸ ë°ì´í„° ê²€ìƒ‰ì„ ìœ„í•´ [Vercel Redis](https://vercel.com/docs/storage/vercel-kv)ì™€ ê°™ì€ ë°ì´í„°ë² ì´ìŠ¤ ì‚¬ìš©ì„ ê³ ë ¤í•´ë³´ì„¸ìš”. í•˜ì§€ë§Œ ê¸°ë³¸ ë°ì´í„°ë² ì´ìŠ¤ì— ì„¸ì…˜ ë°ì´í„°ë¥¼ ìœ ì§€í•˜ê³  ì¿¼ë¦¬ ìˆ˜ë¥¼ ì¤„ì´ê¸° ìœ„í•´ ë°ì´í„° ìš”ì²­ì„ ê²°í•©í•  ìˆ˜ë„ ìˆìŠµë‹ˆë‹¤.
> - ì‚¬ìš©ìê°€ ë§ˆì§€ë§‰ìœ¼ë¡œ ë¡œê·¸ì¸í•œ ì‹œê°„ ì¶”ì , í™œì„± ê¸°ê¸° ìˆ˜ ì¶”ì , ë˜ëŠ” ì‚¬ìš©ìì—ê²Œ ëª¨ë“  ê¸°ê¸°ì—ì„œ ë¡œê·¸ì•„ì›ƒí•  ìˆ˜ ìˆëŠ” ê¸°ëŠ¥ ì œê³µê³¼ ê°™ì€ ë” ê³ ê¸‰ ì‚¬ìš© ì‚¬ë¡€ë¥¼ ìœ„í•´ ë°ì´í„°ë² ì´ìŠ¤ ì„¸ì…˜ì„ ì‚¬ìš©í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

ì„¸ì…˜ ê´€ë¦¬ë¥¼ êµ¬í˜„í•œ í›„ì—ëŠ” ì‚¬ìš©ìê°€ ì• í”Œë¦¬ì¼€ì´ì…˜ ë‚´ì—ì„œ ì ‘ê·¼í•˜ê³  ìˆ˜í–‰í•  ìˆ˜ ìˆëŠ” ì‘ì—…ì„ ì œì–´í•˜ê¸° ìœ„í•œ ê¶Œí•œ ë¶€ì—¬ ë¡œì§ì„ ì¶”ê°€í•´ì•¼ í•©ë‹ˆë‹¤. ìì„¸í•œ ë‚´ìš©ì€ [ê¶Œí•œ ë¶€ì—¬](#authorization) ì„¹ì…˜ì„ ê³„ì† ì½ì–´ë³´ì„¸ìš”.

## ê¶Œí•œ ë¶€ì—¬

ì‚¬ìš©ìê°€ ì¸ì¦ë˜ê³  ì„¸ì…˜ì´ ìƒì„±ë˜ë©´, ì‚¬ìš©ìê°€ ì• í”Œë¦¬ì¼€ì´ì…˜ ë‚´ì—ì„œ ì ‘ê·¼í•˜ê³  ìˆ˜í–‰í•  ìˆ˜ ìˆëŠ” ì‘ì—…ì„ ì œì–´í•˜ê¸° ìœ„í•´ ê¶Œí•œ ë¶€ì—¬ë¥¼ êµ¬í˜„í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

ë‘ ê°€ì§€ ì£¼ìš” ìœ í˜•ì˜ ê¶Œí•œ ë¶€ì—¬ í™•ì¸ì´ ìˆìŠµë‹ˆë‹¤:

1. **ë‚™ê´€ì **: ì¿ í‚¤ì— ì €ì¥ëœ ì„¸ì…˜ ë°ì´í„°ë¥¼ ì‚¬ìš©í•˜ì—¬ ì‚¬ìš©ìê°€ ê²½ë¡œì— ì ‘ê·¼í•˜ê±°ë‚˜ ì‘ì—…ì„ ìˆ˜í–‰í•  ê¶Œí•œì´ ìˆëŠ”ì§€ í™•ì¸í•©ë‹ˆë‹¤. ì´ëŸ¬í•œ í™•ì¸ì€ UI ìš”ì†Œ í‘œì‹œ/ìˆ¨ê¸°ê¸° ë˜ëŠ” ê¶Œí•œì´ë‚˜ ì—­í• ì— ë”°ë¼ ì‚¬ìš©ìë¥¼ ë¦¬ë””ë ‰ì…˜í•˜ëŠ” ë“±ì˜ ë¹ ë¥¸ ì‘ì—…ì— ìœ ìš©í•©ë‹ˆë‹¤.
2. **ì•ˆì „**: ë°ì´í„°ë² ì´ìŠ¤ì— ì €ì¥ëœ ì„¸ì…˜ ë°ì´í„°ë¥¼ ì‚¬ìš©í•˜ì—¬ ì‚¬ìš©ìê°€ ê²½ë¡œì— ì ‘ê·¼í•˜ê±°ë‚˜ ì‘ì—…ì„ ìˆ˜í–‰í•  ê¶Œí•œì´ ìˆëŠ”ì§€ í™•ì¸í•©ë‹ˆë‹¤. ì´ëŸ¬í•œ í™•ì¸ì€ ë” ì•ˆì „í•˜ë©° ë¯¼ê°í•œ ë°ì´í„°ë‚˜ ì‘ì—…ì— ëŒ€í•œ ì ‘ê·¼ì´ í•„ìš”í•œ ì‘ì—…ì— ì‚¬ìš©ë©ë‹ˆë‹¤.

ë‘ ê²½ìš° ëª¨ë‘ ë‹¤ìŒì„ ê¶Œì¥í•©ë‹ˆë‹¤:

- ê¶Œí•œ ë¶€ì—¬ ë¡œì§ì„ ì¤‘ì•™ ì§‘ì¤‘í™”í•˜ê¸° ìœ„í•´ [ë°ì´í„° ì ‘ê·¼ ê³„ì¸µ(DAL) ìƒì„±í•˜ê¸°](#creating-a-data-access-layer-dal)
- í•„ìš”í•œ ë°ì´í„°ë§Œ ë°˜í™˜í•˜ê¸° ìœ„í•´ [ë°ì´í„° ì „ì†¡ ê°ì²´(DTO) ì‚¬ìš©í•˜ê¸°](#using-data-transfer-objects-dto)
- ì„ íƒì ìœ¼ë¡œ ë‚™ê´€ì  í™•ì¸ì„ ìˆ˜í–‰í•˜ê¸° ìœ„í•´ [ë¯¸ë“¤ì›¨ì–´](#optimistic-checks-with-middleware-optional) ì‚¬ìš©í•˜ê¸°

### ë¯¸ë“¤ì›¨ì–´ë¥¼ ì‚¬ìš©í•œ ë‚™ê´€ì  í™•ì¸ (ì„ íƒ ì‚¬í•­)

[ë¯¸ë“¤ì›¨ì–´](/docs/app/building-your-application/routing/middleware)ë¥¼ ì‚¬ìš©í•˜ì—¬ ê¶Œí•œì— ë”°ë¼ ì‚¬ìš©ìë¥¼ ë¦¬ë””ë ‰ì…˜í•˜ê³  ì‹¶ì€ ê²½ìš°ê°€ ìˆìŠµë‹ˆë‹¤:

- ë‚™ê´€ì  í™•ì¸ì„ ìˆ˜í–‰í•˜ê¸° ìœ„í•´. ë¯¸ë“¤ì›¨ì–´ëŠ” ëª¨ë“  ê²½ë¡œì—ì„œ ì‹¤í–‰ë˜ë¯€ë¡œ ë¦¬ë””ë ‰ì…˜ ë¡œì§ì„ ì¤‘ì•™ ì§‘ì¤‘í™”í•˜ê³  ê¶Œí•œì´ ì—†ëŠ” ì‚¬ìš©ìë¥¼ ì‚¬ì „ì— í•„í„°ë§í•˜ëŠ” ì¢‹ì€ ë°©ë²•ì…ë‹ˆë‹¤.
- ì‚¬ìš©ì ê°„ì— ë°ì´í„°ë¥¼ ê³µìœ í•˜ëŠ” ì •ì  ê²½ë¡œë¥¼ ë³´í˜¸í•˜ê¸° ìœ„í•´ (ì˜ˆ: ìœ ë£Œ ì½˜í…ì¸ ).

ê·¸ëŸ¬ë‚˜ ë¯¸ë“¤ì›¨ì–´ëŠ” [í”„ë¦¬í˜ì¹˜ëœ](/docs/app/building-your-application/routing/linking-and-navigating#2-prefetching) ê²½ë¡œë¥¼ í¬í•¨í•œ ëª¨ë“  ê²½ë¡œì—ì„œ ì‹¤í–‰ë˜ë¯€ë¡œ, ì„±ëŠ¥ ë¬¸ì œë¥¼ ë°©ì§€í•˜ê¸° ìœ„í•´ ì¿ í‚¤ì—ì„œ ì„¸ì…˜ì„ ì½ëŠ” ê²ƒ(ë‚™ê´€ì  í™•ì¸)ë§Œ í•˜ê³  ë°ì´í„°ë² ì´ìŠ¤ í™•ì¸ì„ í”¼í•˜ëŠ” ê²ƒì´ ì¤‘ìš”í•©ë‹ˆë‹¤.

ì˜ˆë¥¼ ë“¤ì–´:

```tsx filename="middleware.ts" switcher
import { NextRequest, NextResponse } from "next/server";
import { decrypt } from "@/app/lib/session";
import { cookies } from "next/headers";

// 1. ë³´í˜¸ëœ ê²½ë¡œì™€ ê³µê°œ ê²½ë¡œ ì§€ì •
const protectedRoutes = ["/dashboard"];
const publicRoutes = ["/login", "/signup", "/"];

export default async function middleware(req: NextRequest) {
  // 2. í˜„ì¬ ê²½ë¡œê°€ ë³´í˜¸ëœ ê²½ë¡œì¸ì§€ ê³µê°œ ê²½ë¡œì¸ì§€ í™•ì¸
  const path = req.nextUrl.pathname;
  const isProtectedRoute = protectedRoutes.includes(path);
  const isPublicRoute = publicRoutes.includes(path);

  // 3. ì¿ í‚¤ì—ì„œ ì„¸ì…˜ ë³µí˜¸í™”
  const cookie = cookies().get("session")?.value;
  const session = await decrypt(cookie);

  // 5. ì‚¬ìš©ìê°€ ì¸ì¦ë˜ì§€ ì•Šì€ ê²½ìš° /loginìœ¼ë¡œ ë¦¬ë””ë ‰ì…˜
  if (isProtectedRoute && !session?.userId) {
    return NextResponse.redirect(new URL("/login", req.nextUrl));
  }

  // 6. ì‚¬ìš©ìê°€ ì¸ì¦ëœ ê²½ìš° /dashboardë¡œ ë¦¬ë””ë ‰ì…˜
  if (
    isPublicRoute &&
    session?.userId &&
    !req.nextUrl.pathname.startsWith("/dashboard")
  ) {
    return NextResponse.redirect(new URL("/dashboard", req.nextUrl));
  }

  return NextResponse.next();
}

// ë¯¸ë“¤ì›¨ì–´ê°€ ì‹¤í–‰ë˜ì§€ ì•Šì•„ì•¼ í•˜ëŠ” ê²½ë¡œ
export const config = {
  matcher: ["/((?!api|_next/static|_next/image|.*\\.png$).*)"],
};
```

```js filename="middleware.js" switcher
import { NextResponse } from "next/server";
import { decrypt } from "@/app/lib/session";
import { cookies } from "next/headers";

// 1. ë³´í˜¸ëœ ê²½ë¡œì™€ ê³µê°œ ê²½ë¡œ ì§€ì •
const protectedRoutes = ["/dashboard"];
const publicRoutes = ["/login", "/signup", "/"];

export default async function middleware(req) {
  // 2. í˜„ì¬ ê²½ë¡œê°€ ë³´í˜¸ëœ ê²½ë¡œì¸ì§€ ê³µê°œ ê²½ë¡œì¸ì§€ í™•ì¸
  const path = req.nextUrl.pathname;
  const isProtectedRoute = protectedRoutes.includes(path);
  const isPublicRoute = publicRoutes.includes(path);

  // 3. ì¿ í‚¤ì—ì„œ ì„¸ì…˜ ë³µí˜¸í™”
  const cookie = cookies().get("session")?.value;
  const session = await decrypt(cookie);

  // 5. ì‚¬ìš©ìê°€ ì¸ì¦ë˜ì§€ ì•Šì€ ê²½ìš° /loginìœ¼ë¡œ ë¦¬ë””ë ‰ì…˜
  if (isProtectedRoute && !session?.userId) {
    return NextResponse.redirect(new URL("/login", req.nextUrl));
  }

  // 6. ì‚¬ìš©ìê°€ ì¸ì¦ëœ ê²½ìš° /dashboardë¡œ ë¦¬ë””ë ‰ì…˜
  if (
    isPublicRoute &&
    session?.userId &&
    !req.nextUrl.pathname.startsWith("/dashboard")
  ) {
    return NextResponse.redirect(new URL("/dashboard", req.nextUrl));
  }

  return NextResponse.next();
}

// ë¯¸ë“¤ì›¨ì–´ê°€ ì‹¤í–‰ë˜ì§€ ì•Šì•„ì•¼ í•˜ëŠ” ê²½ë¡œ
export const config = {
  matcher: ["/((?!api|_next/static|_next/image|.*\\.png$).*)"],
};
```

ë¯¸ë“¤ì›¨ì–´ê°€ ì´ˆê¸° í™•ì¸ì— ìœ ìš©í•  ìˆ˜ ìˆì§€ë§Œ, ë°ì´í„°ë¥¼ ë³´í˜¸í•˜ëŠ” ìœ ì¼í•œ ë°©ì–´ì„ ì´ ë˜ì–´ì„œëŠ” ì•ˆ ë©ë‹ˆë‹¤. ë³´ì•ˆ í™•ì¸ì˜ ëŒ€ë¶€ë¶„ì€ ë°ì´í„° ì†ŒìŠ¤ì— ê°€ëŠ¥í•œ í•œ ê°€ê¹ê²Œ ìˆ˜í–‰ë˜ì–´ì•¼ í•©ë‹ˆë‹¤. ìì„¸í•œ ë‚´ìš©ì€ [ë°ì´í„° ì•¡ì„¸ìŠ¤ ê³„ì¸µ](#creating-a-data-access-layer-dal)ì„ ì°¸ì¡°í•˜ì„¸ìš”.

> **íŒ**:
>
> - ë¯¸ë“¤ì›¨ì–´ì—ì„œëŠ” `req.cookies.get('session).value`ë¥¼ ì‚¬ìš©í•˜ì—¬ ì¿ í‚¤ë¥¼ ì½ì„ ìˆ˜ë„ ìˆìŠµë‹ˆë‹¤.
> - ë¯¸ë“¤ì›¨ì–´ëŠ” [Edge Runtime](/docs/app/building-your-application/rendering/edge-and-nodejs-runtimes)ì„ ì‚¬ìš©í•©ë‹ˆë‹¤. ì¸ì¦ ë¼ì´ë¸ŒëŸ¬ë¦¬ì™€ ì„¸ì…˜ ê´€ë¦¬ ë¼ì´ë¸ŒëŸ¬ë¦¬ê°€ í˜¸í™˜ë˜ëŠ”ì§€ í™•ì¸í•˜ì„¸ìš”.
> - ë¯¸ë“¤ì›¨ì–´ì—ì„œ `matcher` ì†ì„±ì„ ì‚¬ìš©í•˜ì—¬ ë¯¸ë“¤ì›¨ì–´ê°€ ì‹¤í–‰ë  ê²½ë¡œë¥¼ ì§€ì •í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ê·¸ëŸ¬ë‚˜ ì¸ì¦ì˜ ê²½ìš°, ë¯¸ë“¤ì›¨ì–´ê°€ ëª¨ë“  ê²½ë¡œì—ì„œ ì‹¤í–‰ë˜ëŠ” ê²ƒì´ ê¶Œì¥ë©ë‹ˆë‹¤.

### ë°ì´í„° ì•¡ì„¸ìŠ¤ ê³„ì¸µ(DAL) ìƒì„±í•˜ê¸°

ë°ì´í„° ìš”ì²­ê³¼ ê¶Œí•œ ë¶€ì—¬ ë¡œì§ì„ ì¤‘ì•™ ì§‘ì¤‘í™”í•˜ê¸° ìœ„í•´ DALì„ ìƒì„±í•˜ëŠ” ê²ƒì„ ê¶Œì¥í•©ë‹ˆë‹¤.

DALì€ ì‚¬ìš©ìê°€ ì• í”Œë¦¬ì¼€ì´ì…˜ê³¼ ìƒí˜¸ ì‘ìš©í•  ë•Œ ì‚¬ìš©ìì˜ ì„¸ì…˜ì„ í™•ì¸í•˜ëŠ” í•¨ìˆ˜ë¥¼ í¬í•¨í•´ì•¼ í•©ë‹ˆë‹¤. ìµœì†Œí•œ ì´ í•¨ìˆ˜ëŠ” ì„¸ì…˜ì´ ìœ íš¨í•œì§€ í™•ì¸í•œ ë‹¤ìŒ, ì¶”ê°€ ìš”ì²­ì„ í•˜ëŠ” ë° í•„ìš”í•œ ì‚¬ìš©ì ì •ë³´ë¥¼ ë¦¬ë””ë ‰ì…˜í•˜ê±°ë‚˜ ë°˜í™˜í•´ì•¼ í•©ë‹ˆë‹¤.

ì˜ˆë¥¼ ë“¤ì–´, `verifySession()` í•¨ìˆ˜ë¥¼ í¬í•¨í•˜ëŠ” DALìš© ë³„ë„ì˜ íŒŒì¼ì„ ë§Œë“­ë‹ˆë‹¤. ê·¸ëŸ° ë‹¤ìŒ Reactì˜ [cache](https://react.dev/reference/react/cache) APIë¥¼ ì‚¬ìš©í•˜ì—¬ React ë Œë”ë§ ê³¼ì • ë™ì•ˆ í•¨ìˆ˜ì˜ ë°˜í™˜ ê°’ì„ ë©”ëª¨ì´ì œì´ì…˜í•©ë‹ˆë‹¤:

```tsx filename="app/lib/dal.ts" switcher
import "server-only";

import { cookies } from "next/headers";
import { decrypt } from "@/app/lib/session";

export const verifySession = cache(async () => {
  const cookie = cookies().get("session")?.value;
  const session = await decrypt(cookie);

  if (!session?.userId) {
    redirect("/login");
  }

  return { isAuth: true, userId: session.userId };
});
```

```js filename="app/lib/dal.js" switcher
import "server-only";

import { cookies } from "next/headers";
import { decrypt } from "@/app/lib/session";

export const verifySession = cache(async () => {
  const cookie = cookies().get("session").value;
  const session = await decrypt(cookie);

  if (!session.userId) {
    redirect("/login");
  }

  return { isAuth: true, userId: session.userId };
});
```

ê·¸ëŸ° ë‹¤ìŒ ë°ì´í„° ìš”ì²­, ì„œë²„ ì•¡ì…˜, ë¼ìš°íŠ¸ í•¸ë“¤ëŸ¬ì—ì„œ `verifySession()` í•¨ìˆ˜ë¥¼ í˜¸ì¶œí•  ìˆ˜ ìˆìŠµë‹ˆë‹¤:

```tsx filename="app/lib/dal.ts" switcher
export const getUser = cache(async () => {
  const session = await verifySession();
  if (!session) return null;

  try {
    const data = await db.query.users.findMany({
      where: eq(users.id, session.userId),
      // ì „ì²´ ì‚¬ìš©ì ê°ì²´ê°€ ì•„ë‹Œ í•„ìš”í•œ ì—´ë§Œ ëª…ì‹œì ìœ¼ë¡œ ë°˜í™˜
      columns: {
        id: true,
        name: true,
        email: true,
      },
    });

    const user = data[0];

    return user;
  } catch (error) {
    console.log("Failed to fetch user");
    return null;
  }
});
```

```jsx filename="app/lib/dal.js" switcher
export const getUser = cache(async () => {
  const session = await verifySession();
  if (!session) return null;

  try {
    const data = await db.query.users.findMany({
      where: eq(users.id, session.userId),
      // ì „ì²´ ì‚¬ìš©ì ê°ì²´ê°€ ì•„ë‹Œ í•„ìš”í•œ ì—´ë§Œ ëª…ì‹œì ìœ¼ë¡œ ë°˜í™˜
      columns: {
        id: true,
        name: true,
        email: true,
      },
    });

    const user = data[0];

    return user;
  } catch (error) {
    console.log("Failed to fetch user");
    return null;
  }
});
```

> **íŒ**:
>
> - DALì€ ìš”ì²­ ì‹œ ê°€ì ¸ì˜¨ ë°ì´í„°ë¥¼ ë³´í˜¸í•˜ëŠ” ë° ì‚¬ìš©ë  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ê·¸ëŸ¬ë‚˜ ì‚¬ìš©ì ê°„ì— ë°ì´í„°ë¥¼ ê³µìœ í•˜ëŠ” ì •ì  ê²½ë¡œì˜ ê²½ìš°, ë°ì´í„°ëŠ” ìš”ì²­ ì‹œê°€ ì•„ë‹Œ ë¹Œë“œ ì‹œì— ê°€ì ¸ì˜µë‹ˆë‹¤. ì •ì  ê²½ë¡œë¥¼ ë³´í˜¸í•˜ë ¤ë©´ [ë¯¸ë“¤ì›¨ì–´](#optimistic-checks-with-middleware-optional)ë¥¼ ì‚¬ìš©í•˜ì„¸ìš”.
> - ì•ˆì „í•œ í™•ì¸ì„ ìœ„í•´ ì„¸ì…˜ IDë¥¼ ë°ì´í„°ë² ì´ìŠ¤ì™€ ë¹„êµí•˜ì—¬ ì„¸ì…˜ì´ ìœ íš¨í•œì§€ í™•ì¸í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ë Œë”ë§ ê³¼ì • ë™ì•ˆ ë°ì´í„°ë² ì´ìŠ¤ì— ëŒ€í•œ ë¶ˆí•„ìš”í•œ ì¤‘ë³µ ìš”ì²­ì„ í”¼í•˜ê¸° ìœ„í•´ Reactì˜ [cache](https://ko.react.dev/reference/react/cache) í•¨ìˆ˜ë¥¼ ì‚¬ìš©í•˜ì„¸ìš”.
> - ëª¨ë“  ë©”ì„œë“œ ì‹¤í–‰ ì „ì— `verifySession()`ì„ ì‹¤í–‰í•˜ëŠ” JavaScript í´ë˜ìŠ¤ì—ì„œ ê´€ë ¨ ë°ì´í„° ìš”ì²­ì„ í†µí•©í•˜ê³  ì‹¶ì„ ìˆ˜ ìˆìŠµë‹ˆë‹¤.

### ë°ì´í„° ì „ì†¡ ê°ì²´(DTO) ì‚¬ìš©í•˜ê¸°

ë°ì´í„°ë¥¼ ê²€ìƒ‰í•  ë•Œ, ì• í”Œë¦¬ì¼€ì´ì…˜ì—ì„œ ì‚¬ìš©ë  í•„ìš”í•œ ë°ì´í„°ë§Œ ë°˜í™˜í•˜ê³  ì „ì²´ ê°ì²´ë¥¼ ë°˜í™˜í•˜ì§€ ì•ŠëŠ” ê²ƒì´ ì¢‹ìŠµë‹ˆë‹¤. ì˜ˆë¥¼ ë“¤ì–´, ì‚¬ìš©ì ë°ì´í„°ë¥¼ ê°€ì ¸ì˜¬ ë•Œ ë¹„ë°€ë²ˆí˜¸, ì „í™”ë²ˆí˜¸ ë“±ì´ í¬í•¨ë  ìˆ˜ ìˆëŠ” ì „ì²´ ì‚¬ìš©ì ê°ì²´ ëŒ€ì‹  ì‚¬ìš©ìì˜ IDì™€ ì´ë¦„ë§Œ ë°˜í™˜í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

ê·¸ëŸ¬ë‚˜ ë°˜í™˜ë˜ëŠ” ë°ì´í„° êµ¬ì¡°ë¥¼ ì œì–´í•  ìˆ˜ ì—†ê±°ë‚˜, í´ë¼ì´ì–¸íŠ¸ì— ì „ì²´ ê°ì²´ê°€ ì „ë‹¬ë˜ëŠ” ê²ƒì„ í”¼í•˜ê³  ì‹¶ì€ íŒ€ì—ì„œ ì‘ì—…í•˜ëŠ” ê²½ìš°, í´ë¼ì´ì–¸íŠ¸ì— ë…¸ì¶œí•´ë„ ì•ˆì „í•œ í•„ë“œë¥¼ ì§€ì •í•˜ëŠ” ë“±ì˜ ì „ëµì„ ì‚¬ìš©í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

```tsx filename="app/lib/dto.ts" switcher
import "server-only";
import { getUser } from "@/app/lib/dal";

function canSeeUsername(viewer: User) {
  return true;
}

function canSeePhoneNumber(viewer: User, team: string) {
  return viewer.isAdmin || team === viewer.team;
}

export async function getProfileDTO(slug: string) {
  const data = await db.query.users.findMany({
    where: eq(users.slug, slug),
    // ì—¬ê¸°ì„œ íŠ¹ì • ì—´ ë°˜í™˜
  });
  const user = data[0];

  const currentUser = await getUser(user.id);

  // ë˜ëŠ” ì—¬ê¸°ì„œ ì¿¼ë¦¬ì— íŠ¹ì •í•œ ê²ƒë§Œ ë°˜í™˜
  return {
    username: canSeeUsername(currentUser) ? user.username : null,
    phonenumber: canSeePhoneNumber(currentUser, user.team)
      ? user.phonenumber
      : null,
  };
}
```

```js filename="app/lib/dto.js" switcher
import "server-only";
import { getUser } from "@/app/lib/dal";

function canSeeUsername(viewer) {
  return true;
}

function canSeePhoneNumber(viewer, team) {
  return viewer.isAdmin || team === viewer.team;
}

export async function getProfileDTO(slug) {
  const data = await db.query.users.findMany({
    where: eq(users.slug, slug),
    // ì—¬ê¸°ì„œ íŠ¹ì • ì—´ ë°˜í™˜
  });
  const user = data[0];

  const currentUser = await getUser(user.id);

  // ë˜ëŠ” ì—¬ê¸°ì„œ ì¿¼ë¦¬ì— íŠ¹ì •í•œ ê²ƒë§Œ ë°˜í™˜
  return {
    username: canSeeUsername(currentUser) ? user.username : null,
    phonenumber: canSeePhoneNumber(currentUser, user.team)
      ? user.phonenumber
      : null,
  };
}
```

DALì—ì„œ ë°ì´í„° ìš”ì²­ê³¼ ê¶Œí•œ ë¶€ì—¬ ë¡œì§ì„ ì¤‘ì•™ ì§‘ì¤‘í™”í•˜ê³  DTOë¥¼ ì‚¬ìš©í•¨ìœ¼ë¡œì¨, ëª¨ë“  ë°ì´í„° ìš”ì²­ì´ ì•ˆì „í•˜ê³  ì¼ê´€ì„± ìˆê²Œ ì´ë£¨ì–´ì§€ë„ë¡ ë³´ì¥í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ì´ëŠ” ì• í”Œë¦¬ì¼€ì´ì…˜ì´ í™•ì¥ë¨ì— ë”°ë¼ ìœ ì§€ ê´€ë¦¬, ê°ì‚¬, ë””ë²„ê¹…ì„ ë” ì‰½ê²Œ ë§Œë“­ë‹ˆë‹¤.

> **ì•Œì•„ë‘ë©´ ì¢‹ì€ ì **:
>
> - DTOë¥¼ ì •ì˜í•˜ëŠ” ë°©ë²•ì€ ì—¬ëŸ¬ ê°€ì§€ê°€ ìˆìŠµë‹ˆë‹¤. `toJSON()`ì„ ì‚¬ìš©í•˜ëŠ” ë°©ë²•, ìœ„ì˜ ì˜ˆì œì™€ ê°™ì€ ê°œë³„ í•¨ìˆ˜, ë˜ëŠ” JS í´ë˜ìŠ¤ ë“±ì´ ìˆìŠµë‹ˆë‹¤. ì´ëŠ” JavaScript íŒ¨í„´ì´ë©° Reactë‚˜ Next.js ê¸°ëŠ¥ì´ ì•„ë‹ˆë¯€ë¡œ, ì• í”Œë¦¬ì¼€ì´ì…˜ì— ê°€ì¥ ì í•©í•œ íŒ¨í„´ì„ ì°¾ê¸° ìœ„í•´ ì¡°ì‚¬í•´ ë³´ëŠ” ê²ƒì„ ê¶Œì¥í•©ë‹ˆë‹¤.
> - [Next.jsì˜ ë³´ì•ˆ ëª¨ë²” ì‚¬ë¡€ ê¸°ì‚¬](/blog/security-nextjs-server-components-actions)ì—ì„œ ë³´ì•ˆ ëª¨ë²” ì‚¬ë¡€ì— ëŒ€í•´ ìì„¸íˆ ì•Œì•„ë³´ì„¸ìš”.

### ì„œë²„ ì»´í¬ë„ŒíŠ¸

[ì„œë²„ ì»´í¬ë„ŒíŠ¸](/docs/app/building-your-application/rendering/server-components)ì—ì„œì˜ ì¸ì¦ í™•ì¸ì€ ì—­í•  ê¸°ë°˜ ì ‘ê·¼ì— ìœ ìš©í•©ë‹ˆë‹¤. ì˜ˆë¥¼ ë“¤ì–´, ì‚¬ìš©ìì˜ ì—­í• ì— ë”°ë¼ ì¡°ê±´ë¶€ë¡œ ì»´í¬ë„ŒíŠ¸ë¥¼ ë Œë”ë§í•˜ëŠ” ê²½ìš°:

```tsx filename="app/dashboard/page.tsx" switcher
import { verifySession } from "@/app/lib/dal";

export default function Dashboard() {
  const session = await verifySession();
  const userRole = session?.user?.role; // 'role'ì´ ì„¸ì…˜ ê°ì²´ì˜ ì¼ë¶€ë¼ê³  ê°€ì •

  if (userRole === "admin") {
    return <AdminDashboard />;
  } else if (userRole === "user") {
    return <UserDashboard />;
  } else {
    redirect("/login");
  }
}
```

```jsx filename="app/dashboard/page.jsx" switcher
import { verifySession } from '@/app/lib/dal'

export default function Dashboard() {
  const session = await verifySession()
  const userRole = session.role // 'role'ì´ ì„¸ì…˜ ê°ì²´ì˜ ì¼ë¶€ë¼ê³  ê°€ì •

  if (userRole === 'admin') {
    return <AdminDashboard />
  } else if (userRole === 'user') {
    return <UserDashboard />
  } else {
    redirect('/login')
  }
}
```

ì´ ì˜ˆì œì—ì„œëŠ” DALì˜ `verifySession()` í•¨ìˆ˜ë¥¼ ì‚¬ìš©í•˜ì—¬ 'admin', 'user', ê·¸ë¦¬ê³  ê¶Œí•œì´ ì—†ëŠ” ì—­í• ì„ í™•ì¸í•©ë‹ˆë‹¤. ì´ íŒ¨í„´ì€ ê° ì‚¬ìš©ìê°€ ìì‹ ì˜ ì—­í• ì— ì í•©í•œ ì»´í¬ë„ŒíŠ¸ì™€ë§Œ ìƒí˜¸ ì‘ìš©í•˜ë„ë¡ ë³´ì¥í•©ë‹ˆë‹¤.

### ë ˆì´ì•„ì›ƒê³¼ ì¸ì¦ í™•ì¸

[ë¶€ë¶„ ë Œë”ë§](/docs/app/building-your-application/routing/linking-and-navigating#4-partial-rendering)ìœ¼ë¡œ ì¸í•´, [ë ˆì´ì•„ì›ƒ](/docs/app/building-your-application/routing/layouts-and-templates)ì—ì„œ í™•ì¸ì„ ìˆ˜í–‰í•  ë•Œ ì£¼ì˜í•´ì•¼ í•©ë‹ˆë‹¤. ë ˆì´ì•„ì›ƒì€ ë„¤ë¹„ê²Œì´ì…˜ ì‹œ ë‹¤ì‹œ ë Œë”ë§ë˜ì§€ ì•Šê¸° ë•Œë¬¸ì— ì‚¬ìš©ì ì„¸ì…˜ì´ ëª¨ë“  ê²½ë¡œ ë³€ê²½ì—ì„œ í™•ì¸ë˜ì§€ ì•ŠìŠµë‹ˆë‹¤.

ëŒ€ì‹ , ë°ì´í„° ì†ŒìŠ¤ë‚˜ ì¡°ê±´ë¶€ë¡œ ë Œë”ë§ë  ì»´í¬ë„ŒíŠ¸ì— ê°€ê¹ê²Œ í™•ì¸ì„ ìˆ˜í–‰í•´ì•¼ í•©ë‹ˆë‹¤.

ì˜ˆë¥¼ ë“¤ì–´, ì‚¬ìš©ì ë°ì´í„°ë¥¼ ê°€ì ¸ì˜¤ê³  ë„¤ë¹„ê²Œì´ì…˜ì— ì‚¬ìš©ì ì´ë¯¸ì§€ë¥¼ í‘œì‹œí•˜ëŠ” ê³µìœ  ë ˆì´ì•„ì›ƒì„ ê³ ë ¤í•´ë³´ì„¸ìš”. ë ˆì´ì•„ì›ƒì—ì„œ ì¸ì¦ í™•ì¸ì„ ìˆ˜í–‰í•˜ëŠ” ëŒ€ì‹ , ë ˆì´ì•„ì›ƒì—ì„œ ì‚¬ìš©ì ë°ì´í„°(`getUser()`)ë¥¼ ê°€ì ¸ì˜¤ê³  DALì—ì„œ ì¸ì¦ í™•ì¸ì„ ìˆ˜í–‰í•´ì•¼ í•©ë‹ˆë‹¤.

ì´ë ‡ê²Œ í•˜ë©´ ì• í”Œë¦¬ì¼€ì´ì…˜ ë‚´ì—ì„œ `getUser()`ê°€ í˜¸ì¶œë˜ëŠ” ê³³ë§ˆë‹¤ ì¸ì¦ í™•ì¸ì´ ìˆ˜í–‰ë˜ë„ë¡ ë³´ì¥í•˜ë©°, ê°œë°œìê°€ ë°ì´í„°ì— ì ‘ê·¼í•  ê¶Œí•œì´ ìˆëŠ”ì§€ í™•ì¸í•˜ëŠ” ê²ƒì„ ìŠëŠ” ê²ƒì„ ë°©ì§€í•©ë‹ˆë‹¤.

```tsx filename="app/layout.tsx" switcher
export default async function Layout({
  children,
}: {
  children: React.ReactNode;
}) {
  const user = await getUser();

  return (
    // ...
  )
}
```

```jsx filename="app/layout.js" switcher
export default async function Layout({ children }) {
  const user = await getUser();

  return (
    // ...
  )
}
```

```ts filename="app/lib/dal.ts" switcher
export const getUser = cache(async () => {
  const session = await verifySession();
  if (!session) return null;

  // ì„¸ì…˜ì—ì„œ ì‚¬ìš©ì IDë¥¼ ê°€ì ¸ì™€ ë°ì´í„° ì¡°íšŒ
});
```

```js filename="app/lib/dal.js" switcher
export const getUser = cache(async () => {
  const session = await verifySession();
  if (!session) return null;

  // ì„¸ì…˜ì—ì„œ ì‚¬ìš©ì IDë¥¼ ê°€ì ¸ì™€ ë°ì´í„° ì¡°íšŒ
});
```

> **ì•Œì•„ë‘ë©´ ì¢‹ì€ ì :**
>
> - SPAì—ì„œ í”í•œ íŒ¨í„´ì€ ì‚¬ìš©ìê°€ ì¸ì¦ë˜ì§€ ì•Šì€ ê²½ìš° ë ˆì´ì•„ì›ƒì´ë‚˜ ìµœìƒìœ„ ì»´í¬ë„ŒíŠ¸ì—ì„œ `return null`ì„ í•˜ëŠ” ê²ƒì…ë‹ˆë‹¤. ì´ íŒ¨í„´ì€ **ê¶Œì¥ë˜ì§€ ì•ŠìŠµë‹ˆë‹¤**. Next.js ì• í”Œë¦¬ì¼€ì´ì…˜ì€ ì—¬ëŸ¬ ì§„ì…ì ì´ ìˆì–´ ì¤‘ì²©ëœ ê²½ë¡œ ì„¸ê·¸ë¨¼íŠ¸ì™€ ì„œë²„ ì•¡ì…˜ì— ëŒ€í•œ ì ‘ê·¼ì„ ë°©ì§€í•˜ì§€ ëª»í•˜ê¸° ë•Œë¬¸ì…ë‹ˆë‹¤.

### ì„œë²„ ì•¡ì…˜

[ì„œë²„ ì•¡ì…˜](/docs/app/building-your-application/data-fetching/server-actions-and-mutations)ë¥¼ ê³µê°œ API ì—”ë“œí¬ì¸íŠ¸ì™€ ë™ì¼í•œ ë³´ì•ˆ ê³ ë ¤ì‚¬í•­ìœ¼ë¡œ ì·¨ê¸‰í•˜ê³ , ì‚¬ìš©ìê°€ ë³€ê²½ì„ ìˆ˜í–‰í•  ê¶Œí•œì´ ìˆëŠ”ì§€ í™•ì¸í•˜ì„¸ìš”.

ì•„ë˜ ì˜ˆì œì—ì„œëŠ” ì‘ì—…ì„ ì§„í–‰í•˜ê¸° ì „ì— ì‚¬ìš©ìì˜ ì—­í• ì„ í™•ì¸í•©ë‹ˆë‹¤:

```ts filename="app/lib/actions.ts" switcher
"use server";
import { verifySession } from "@/app/lib/dal";

export async function serverAction(formData: FormData) {
  const session = await verifySession();
  const userRole = session?.user?.role;

  // ì‚¬ìš©ìê°€ ì‘ì—…ì„ ìˆ˜í–‰í•  ê¶Œí•œì´ ì—†ìœ¼ë©´ ì¼ì° ë°˜í™˜
  if (userRole !== "admin") {
    return null;
  }

  // ê¶Œí•œì´ ìˆëŠ” ì‚¬ìš©ìì— ëŒ€í•´ ì‘ì—… ì§„í–‰
}
```

```js filename="app/lib/actions.js" switcher
"use server";
import { verifySession } from "@/app/lib/dal";

export async function serverAction() {
  const session = await verifySession();
  const userRole = session.user.role;

  // ì‚¬ìš©ìê°€ ì‘ì—…ì„ ìˆ˜í–‰í•  ê¶Œí•œì´ ì—†ìœ¼ë©´ ì¼ì° ë°˜í™˜
  if (userRole !== "admin") {
    return null;
  }

  // ê¶Œí•œì´ ìˆëŠ” ì‚¬ìš©ìì— ëŒ€í•´ ì‘ì—… ì§„í–‰
}
```

### ë¼ìš°íŠ¸ í•¸ë“¤ëŸ¬

[ë¼ìš°íŠ¸ í•¸ë“¤ëŸ¬](/docs/app/building-your-application/routing/route-handlers)ë¥¼ ê³µê°œ API ì—”ë“œí¬ì¸íŠ¸ì™€ ë™ì¼í•œ ë³´ì•ˆ ê³ ë ¤ì‚¬í•­ìœ¼ë¡œ ì·¨ê¸‰í•˜ê³ , ì‚¬ìš©ìê°€ Route Handlerì— ì ‘ê·¼í•  ê¶Œí•œì´ ìˆëŠ”ì§€ í™•ì¸í•˜ì„¸ìš”.

ì˜ˆë¥¼ ë“¤ì–´:

```ts filename="app/api/route.ts" switcher
import { verifySession } from "@/app/lib/dal";

export async function GET() {
  // ì‚¬ìš©ì ì¸ì¦ ë° ì—­í•  í™•ì¸
  const session = await verifySession();

  // ì‚¬ìš©ìê°€ ì¸ì¦ë˜ì—ˆëŠ”ì§€ í™•ì¸
  if (!session) {
    // ì‚¬ìš©ìê°€ ì¸ì¦ë˜ì§€ ì•ŠìŒ
    return new Response(null, { status: 401 });
  }

  // ì‚¬ìš©ìê°€ 'admin' ì—­í• ì„ ê°€ì§€ê³  ìˆëŠ”ì§€ í™•ì¸
  if (session.user.role !== "admin") {
    // ì‚¬ìš©ìê°€ ì¸ì¦ë˜ì—ˆì§€ë§Œ ì ì ˆí•œ ê¶Œí•œì´ ì—†ìŒ
    return new Response(null, { status: 403 });
  }

  // ê¶Œí•œì´ ìˆëŠ” ì‚¬ìš©ìì— ëŒ€í•´ ê³„ì† ì§„í–‰
}
```

```js filename="app/api/route.js" switcher
import { verifySession } from "@/app/lib/dal";

export async function GET() {
  // ì‚¬ìš©ì ì¸ì¦ ë° ì—­í•  í™•ì¸
  const session = await verifySession();

  // ì‚¬ìš©ìê°€ ì¸ì¦ë˜ì—ˆëŠ”ì§€ í™•ì¸
  if (!session) {
    // ì‚¬ìš©ìê°€ ì¸ì¦ë˜ì§€ ì•ŠìŒ
    return new Response(null, { status: 401 });
  }

  // ì‚¬ìš©ìê°€ 'admin' ì—­í• ì„ ê°€ì§€ê³  ìˆëŠ”ì§€ í™•ì¸
  if (session.user.role !== "admin") {
    // ì‚¬ìš©ìê°€ ì¸ì¦ë˜ì—ˆì§€ë§Œ ì ì ˆí•œ ê¶Œí•œì´ ì—†ìŒ
    return new Response(null, { status: 403 });
  }

  // ê¶Œí•œì´ ìˆëŠ” ì‚¬ìš©ìì— ëŒ€í•´ ê³„ì† ì§„í–‰
}
```

ìœ„ì˜ ì˜ˆì œëŠ” 2ë‹¨ê³„ ë³´ì•ˆ í™•ì¸ì´ ìˆëŠ” Route Handlerë¥¼ ë³´ì—¬ì¤ë‹ˆë‹¤. ë¨¼ì € í™œì„± ì„¸ì…˜ì´ ìˆëŠ”ì§€ í™•ì¸í•˜ê³ , ê·¸ ë‹¤ìŒ ë¡œê·¸ì¸í•œ ì‚¬ìš©ìê°€ 'admin'ì¸ì§€ í™•ì¸í•©ë‹ˆë‹¤.

## ì»¨í…ìŠ¤íŠ¸ í”„ë¡œë°”ì´ë” (Context Providers)

[ì¸í„°ë¦¬ë¹™](#interleaving-server-and-client-components) ë•ë¶„ì— ì¸ì¦ì„ ìœ„í•œ ì»¨í…ìŠ¤íŠ¸ í”„ë¡œë°”ì´ë”(Context Providers) ì‚¬ìš©ì´ ê°€ëŠ¥í•©ë‹ˆë‹¤. ê·¸ëŸ¬ë‚˜ Reactì˜ `context`ëŠ” ì„œë²„ ì»´í¬ë„ŒíŠ¸ì—ì„œëŠ” ì§€ì›ë˜ì§€ ì•Šì•„ í´ë¼ì´ì–¸íŠ¸ ì»´í¬ë„ŒíŠ¸ì—ë§Œ ì ìš©í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

ì´ ë°©ì‹ì€ ì‘ë™í•˜ì§€ë§Œ, ìì‹ ì„œë²„ ì»´í¬ë„ŒíŠ¸ëŠ” ë¨¼ì € ì„œë²„ì—ì„œ ë Œë”ë§ë˜ë©°, ì»¨í…ìŠ¤íŠ¸ í”„ë¡œë°”ì´ë”(Context Providers)ì˜ ì„¸ì…˜ ë°ì´í„°ì— ì ‘ê·¼í•  ìˆ˜ ì—†ìŠµë‹ˆë‹¤.

```tsx filename="app/layout.ts" switcher
import { ContextProvider } from "auth-lib";

export default function RootLayout({ children }) {
  return (
    <html lang="en">
      <body>
        <ContextProvider>{children}</ContextProvider>
      </body>
    </html>
  );
}
```

```tsx filename="app/ui/profile.ts switcher
"use client";

import { useSession } from "auth-lib";

export default function Profile() {
  const { userId } = useSession();
  const { data } = useSWR(`/api/user/${userId}`, fetcher)

  return (
    // ...
  );
}
```

```jsx filename="app/ui/profile.js switcher
"use client";

import { useSession } from "auth-lib";

export default function Profile() {
  const { userId } = useSession();
  const { data } = useSWR(`/api/user/${userId}`, fetcher)

  return (
    // ...
  );
}
```

Client Componentsì—ì„œ ì„¸ì…˜ ë°ì´í„°ê°€ í•„ìš”í•œ ê²½ìš°(ì˜ˆ: í´ë¼ì´ì–¸íŠ¸ ì¸¡ ë°ì´í„° ê°€ì ¸ì˜¤ê¸°), Reactì˜ [`taintUniqueValue`](https://react.dev/reference/react/experimental_taintUniqueValue) APIë¥¼ ì‚¬ìš©í•˜ì—¬ ë¯¼ê°í•œ ì„¸ì…˜ ë°ì´í„°ê°€ í´ë¼ì´ì–¸íŠ¸ì— ë…¸ì¶œë˜ëŠ” ê²ƒì„ ë°©ì§€í•˜ì„¸ìš”.

## ë¦¬ì†ŒìŠ¤

ì´ì œ Next.jsì˜ ì¸ì¦ì— ëŒ€í•´ ë°°ì› ìœ¼ë‹ˆ, ì•ˆì „í•œ ì¸ì¦ ë° ì„¸ì…˜ ê´€ë¦¬ë¥¼ êµ¬í˜„í•˜ëŠ” ë° ë„ì›€ì´ ë˜ëŠ” Next.js í˜¸í™˜ ë¼ì´ë¸ŒëŸ¬ë¦¬ì™€ ë¦¬ì†ŒìŠ¤ë¥¼ ì†Œê°œí•©ë‹ˆë‹¤:

### ì¸ì¦ ë¼ì´ë¸ŒëŸ¬ë¦¬

- [Auth0](https://auth0.com/docs/quickstart/webapp/nextjs/01-login)
- [Clerk](https://clerk.com/docs/quickstarts/nextjs)
- [Kinde](https://kinde.com/docs/developer-tools/nextjs-sdk)
- [Lucia](https://lucia-auth.com/getting-started/nextjs-app)
- [NextAuth.js](https://authjs.dev/getting-started/installation?framework=next.js)
- [Stack Auth](https://docs.stack-auth.com/getting-started/setup)
- [Supabase](https://supabase.com/docs/guides/getting-started/quickstarts/nextjs)
- [Stytch](https://stytch.com/docs/guides/quickstarts/nextjs)
- [WorkOS](https://workos.com/docs/user-management)

### ì„¸ì…˜ ê´€ë¦¬ ë¼ì´ë¸ŒëŸ¬ë¦¬

- [Iron Session](https://github.com/vvo/iron-session)
- [Jose](https://github.com/panva/jose)

## ì¶”ê°€ ì½ê¸°

ì¸ì¦ê³¼ ë³´ì•ˆì— ëŒ€í•´ ê³„ì† í•™ìŠµí•˜ë ¤ë©´ ë‹¤ìŒ ë¦¬ì†ŒìŠ¤ë¥¼ í™•ì¸í•˜ì„¸ìš”:

- [Next.jsì—ì„œ ë³´ì•ˆì— ëŒ€í•´ ìƒê°í•˜ëŠ” ë°©ë²•](/blog/security-nextjs-server-components-actions)
- [XSS ê³µê²© ì´í•´í•˜ê¸°](https://vercel.com/guides/understanding-xss-attacks)
- [CSRF ê³µê²© ì´í•´í•˜ê¸°](https://vercel.com/guides/understanding-csrf-attacks)
- [The Copenhagen Book](https://thecopenhagenbook.com/)
